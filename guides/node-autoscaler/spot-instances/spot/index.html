
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://cast.ai/guides/node-autoscaler/spot-instances/spot/">
      
      <link rel="shortcut icon" href="../../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.6">
    
    
      
        <title>Spot/Preemptible Instances - CAST AI Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nimbus+Sans:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"Nimbus Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="indigo">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotpreemptible-instances" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://cast.ai" title="CAST AI Documentation" class="md-header-nav__button md-logo" aria-label="CAST AI Documentation">
      <img src="../../../../img/cast-logo-dark-blue.svg" alt="Cast logo" style="width: 5em;" />
    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            CAST AI Documentation
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Spot/Preemptible Instances
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://cast.ai" title="CAST AI Documentation" class="md-nav__button md-logo" aria-label="CAST AI Documentation">
      <img src="../../../../img/cast-logo-dark-blue.svg" alt="Cast logo" style="width: 5em;" />
    </a>
    CAST AI Documentation
  </label>
  
    <div class="md-nav__source">
      
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-help/" class="md-nav__link">
        Getting help
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
      
      <label class="md-nav__link" for="nav-3">
        Getting started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/setting-up-account/" class="md-nav__link">
        Setting up an account
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" >
      
      <label class="md-nav__link" for="nav-3-2">
        Setting up credentials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Setting up credentials" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Setting up credentials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/configuring-gcp-credentials/" class="md-nav__link">
        Configure Google Cloud credentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/configuring-aws-credentials/" class="md-nav__link">
        Configure AWS credentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/configuring-do-credentials/" class="md-nav__link">
        Configure Digital Ocean credentials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/configuring-azure-credentials/" class="md-nav__link">
        Configure Azure credentials
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/creating-your-first-cluster/" class="md-nav__link">
        Creating your first cluster
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../getting-started/deploying-applications/" class="md-nav__link">
        Deploying Applications
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Concepts
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Concepts" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/how-it-works/" class="md-nav__link">
        How it works
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../concepts/architecture-overview/" class="md-nav__link">
        Cluster architecture overview
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
      
      <label class="md-nav__link" for="nav-5">
        Developer guides
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer guides" data-md-level="1">
        <label class="md-nav__title" for="nav-5">
          <span class="md-nav__icon md-icon"></span>
          Developer guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../pod-pinning/" class="md-nav__link">
        Configure pod placement by topology
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../volumes/" class="md-nav__link">
        Dynamic volume provisioning
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../autoscaling-policies/" class="md-nav__link">
        Autoscaling policies
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../pod-autoscaler/hpa/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../ingress/" class="md-nav__link">
        Exposing your app to the internet
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Spot/Preemptible Instances
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Spot/Preemptible Instances
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-configurations" class="md-nav__link">
    Available configurations
  </a>
  
    <nav class="md-nav" aria-label="Available configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tolerations" class="md-nav__link">
    Tolerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-selectors" class="md-nav__link">
    Node Selectors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-deployment-on-spot-instance" class="md-nav__link">
    Step-by-step deployment on Spot Instance
  </a>
  
    <nav class="md-nav" aria-label="Step-by-step deployment on Spot Instance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-pre-requisites" class="md-nav__link">
    0. Pre-requisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-enable-relevant-policies" class="md-nav__link">
    1. Enable relevant policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-example-deployment" class="md-nav__link">
    2. Example deployment
  </a>
  
    <nav class="md-nav" aria-label="2. Example deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-apply-the-example-deployment" class="md-nav__link">
    2.1. Apply the example deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-wait-several-minutes" class="md-nav__link">
    2.2. Wait several minutes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-spot-instance-added" class="md-nav__link">
    3. Spot Instance added
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-aws-instance-list" class="md-nav__link">
    3.1. AWS instance list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" >
      
      <label class="md-nav__link" for="nav-6">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="nav-6">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/overview/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/specification/" class="md-nav__link">
        API specification
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/terraform-provider/" class="md-nav__link">
        Terraform provider
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-configurations" class="md-nav__link">
    Available configurations
  </a>
  
    <nav class="md-nav" aria-label="Available configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tolerations" class="md-nav__link">
    Tolerations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-selectors" class="md-nav__link">
    Node Selectors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-by-step-deployment-on-spot-instance" class="md-nav__link">
    Step-by-step deployment on Spot Instance
  </a>
  
    <nav class="md-nav" aria-label="Step-by-step deployment on Spot Instance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#0-pre-requisites" class="md-nav__link">
    0. Pre-requisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-enable-relevant-policies" class="md-nav__link">
    1. Enable relevant policies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-example-deployment" class="md-nav__link">
    2. Example deployment
  </a>
  
    <nav class="md-nav" aria-label="2. Example deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-apply-the-example-deployment" class="md-nav__link">
    2.1. Apply the example deployment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-wait-several-minutes" class="md-nav__link">
    2.2. Wait several minutes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-spot-instance-added" class="md-nav__link">
    3. Spot Instance added
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-aws-instance-list" class="md-nav__link">
    3.1. AWS instance list
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/castai/docs/edit/main/docs/guides/node-autoscaler/spot-instances/spot.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="spotpreemptible-instances">Spot/Preemptible Instances<a class="headerlink" href="#spotpreemptible-instances" title="Permanent link">&para;</a></h1>
<p>The CAST AI autoscaler supports running your workloads on Spot/Preemtible instances.
In this guide, we will show you just how easy it is to do that.</p>
<h2 id="available-configurations">Available configurations<a class="headerlink" href="#available-configurations" title="Permanent link">&para;</a></h2>
<h3 id="tolerations">Tolerations<a class="headerlink" href="#tolerations" title="Permanent link">&para;</a></h3>
<p>When a pod is marked only with Toleration, the Kubernetes scheduler could place such a pod/pods on regular nodes as well.
This option should be preferred when spot instances are optional for your workloads.</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">tolerations</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scheduling.cast.ai/spot</span>
    <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Exists</span>
<span class="nn">...</span>
</code></pre></div>
<h3 id="node-selectors">Node Selectors<a class="headerlink" href="#node-selectors" title="Permanent link">&para;</a></h3>
<p>If you want to make sure that a pod is scheduled on spot instances only, in addition to tolerations, you must add <code>nodeSelector</code> as well.
That way, the autoscaler ensures that whenever your pod requires additional workload in the cluster, only a spot instance is picked to satisfy the needs.</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">tolerations</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scheduling.cast.ai/spot</span>
    <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Exists</span>
<span class="nt">nodeSelector</span><span class="p">:</span>
  <span class="nt">scheduling.cast.ai/spot</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
<span class="nn">...</span>
</code></pre></div>
<h2 id="step-by-step-deployment-on-spot-instance">Step-by-step deployment on Spot Instance<a class="headerlink" href="#step-by-step-deployment-on-spot-instance" title="Permanent link">&para;</a></h2>
<p>In this step-by-step guide, we demonstrate how to use Spot Instances with your CAST AI clusters.</p>
<p>To do that, we will be using example NGINX deployment configured to only be ran on Spot/Preemtible instances.</p>
<h3 id="0-pre-requisites">0. Pre-requisites<a class="headerlink" href="#0-pre-requisites" title="Permanent link">&para;</a></h3>
<ul>
<li>Have a Kubernetes cluster on CAST AI</li>
<li>Check <a href="../../../../getting-started/creating-your-first-cluster/">Creating your first cluster</a> if you need guidance.</li>
<li><code>Kubeconfig</code> downloaded and ready to use for deploying an example application to your cluster.</li>
</ul>
<p><img alt="" src="../010_demo_cluster.png" /></p>
<h3 id="1-enable-relevant-policies">1. Enable relevant policies<a class="headerlink" href="#1-enable-relevant-policies" title="Permanent link">&para;</a></h3>
<p>To get started on using Spot instances autoscaler, you should enable two policies under <code>Policies</code> configuration in the UI:</p>
<ul>
<li><strong>Spot/Preemptible instances policy</strong></li>
<li>This policy allows the autoscaler to use spot instances</li>
<li><strong>Unschedulable pods policy</strong></li>
<li>This policy requests an additional workload to be scheduled based on your deployment requires (i.e. run on spot instances)</li>
</ul>
<p><img alt="" src="../020_enable_policies.png" /></p>
<h3 id="2-example-deployment">2. Example deployment<a class="headerlink" href="#2-example-deployment" title="Permanent link">&para;</a></h3>
<p>Save the following <em>yaml</em> file, and name it: <code>nginx.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx-deployment</span>
  <span class="nt">labels</span><span class="p">:</span>
    <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">replicas</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">selector</span><span class="p">:</span>
    <span class="nt">matchLabels</span><span class="p">:</span>
      <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
  <span class="nt">template</span><span class="p">:</span>
    <span class="nt">metadata</span><span class="p">:</span>
      <span class="nt">labels</span><span class="p">:</span>
        <span class="nt">app</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
    <span class="nt">spec</span><span class="p">:</span>
      <span class="nt">nodeSelector</span><span class="p">:</span>
        <span class="nt">scheduling.cast.ai/spot</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
        <span class="nt">topology.cast.ai/csp</span><span class="p">:</span> <span class="s">&quot;aws&quot;</span>
      <span class="nt">tolerations</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">scheduling.cast.ai/spot</span>
          <span class="nt">operator</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Exists</span>
      <span class="nt">containers</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx</span>
          <span class="nt">image</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">nginx:1.14.2</span>
          <span class="nt">ports</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="nt">containerPort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
          <span class="nt">resources</span><span class="p">:</span>
            <span class="nt">requests</span><span class="p">:</span>
              <span class="nt">cpu</span><span class="p">:</span> <span class="s">&#39;2&#39;</span>
            <span class="nt">limits</span><span class="p">:</span>
              <span class="nt">cpu</span><span class="p">:</span> <span class="s">&#39;3&#39;</span>
</code></pre></div>
<h4 id="21-apply-the-example-deployment">2.1. Apply the example deployment<a class="headerlink" href="#21-apply-the-example-deployment" title="Permanent link">&para;</a></h4>
<p>With Kubeconfig set in your current shell session, you can execute the following (or use other means of applying deployment files):</p>
<p><code>kubectl apply -f ngninx.yaml</code></p>
<p><img alt="" src="../030_deployment_in_lens.png" /></p>
<h4 id="22-wait-several-minutes">2.2. Wait several minutes<a class="headerlink" href="#22-wait-several-minutes" title="Permanent link">&para;</a></h4>
<p>Once the deployment is created, it will take up to several minutes for the autoscaler to pick up the information about your pending deployment and schedule the relevant workloads in order to satisfy the deployment needs, such as:</p>
<ul>
<li>This deployment <strong>tolerates spot instances</strong></li>
<li>This deployment <strong>must run only on spot instances</strong></li>
</ul>
<h3 id="3-spot-instance-added">3. Spot Instance added<a class="headerlink" href="#3-spot-instance-added" title="Permanent link">&para;</a></h3>
<ul>
<li>You can see your newly added spot instance in the cluster node list.</li>
</ul>
<p><img alt="" src="../040_spot_instance_added.png" /></p>
<h3 id="31-aws-instance-list">3.1. AWS instance list<a class="headerlink" href="#31-aws-instance-list" title="Permanent link">&para;</a></h3>
<p>Just to double check, go to AWS console and check that the added node has the <code>Lifecycle: spot</code> indicator.</p>
<p><img alt="" src="../050_aws_node_list.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../../ingress/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Exposing your app to the internet
              </div>
            </div>
          </a>
        
        
          <a href="../../../../api/overview/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Introduction
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.53cc9318.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.e9c9f54f.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: [],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>